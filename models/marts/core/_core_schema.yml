version: 2

models:
  - name: dim_customers
    description: >
      Customer dimension enriched with behavioral metrics, automatic segmentation
      and geographic classifications. Includes activity information,
      customer value and engagement status.
    columns:
      - name: customer_id
        description: Unique customer identifier (PK)
        tests:
          - unique
          - not_null
      
      - name: customer_name
        description: Customer full name (first_name + last_name)
        tests:
          - not_null
      
      - name: email
        description: Customer email for communications
        tests:
          - not_null
      
      - name: total_orders
        description: Total number of completed orders by customer
        tests:
          - dbt_utils.at_least_one
      
      - name: lifetime_revenue
        description: Total revenue generated by customer over time
        tests:
          - dbt_utils.at_least_one
      
      - name: activity_status
        description: Customer activity status based on last purchase
        tests:
          - accepted_values:
              values: ['Prospect', 'Active', 'At Risk', 'Dormant', 'Lost']
      
      - name: value_segment
        description: Value segmentation based on lifetime revenue
        tests:
          - accepted_values:
              values: ['Prospect', 'New', 'Regular', 'VIP', 'Platinum']
      
      - name: region
        description: Geographic classification by United States region
        tests:
          - accepted_values:
              values: ['West', 'Southwest', 'Midwest', 'Northeast', 'Southeast', 'Other']

  - name: dim_products
    description: >
      Product dimension with category information, suppliers, margins
      and performance metrics. Includes price classifications and activity status.
    columns:
      - name: product_id
        description: Unique product identifier (PK)
        tests:
          - unique
          - not_null
      
      - name: product_name
        description: Product name
        tests:
          - not_null
      
      - name: category
        description: Product category
        tests:
          - not_null
      
      - name: category_group
        description: High-level category group
        tests:
          - not_null
      
      - name: retail_price
        description: Retail selling price
        tests:
          - dbt_utils.at_least_one
      
      - name: margin_percent
        description: Calculated margin percentage
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100
      
      - name: product_status
        description: Product status based on sales activity
        tests:
          - accepted_values:
              values: ['Never Sold', 'Active', 'Slow Moving', 'Inactive']
      
      - name: price_tier
        description: Classification by price range
        tests:
          - accepted_values:
              values: ['Budget', 'Standard', 'Premium', 'Luxury']

  - name: dim_employees
    description: >
      Employee dimension with role information, organizational hierarchy,
      performance metrics and classifications by department and tenure.
    columns:
      - name: employee_id
        description: Unique employee identifier (PK)
        tests:
          - unique
          - not_null
      
      - name: employee_name
        description: Employee full name
        tests:
          - not_null
      
      - name: job_title
        description: Job position title
        tests:
          - not_null
      
      - name: department
        description: Employee organizational department
        tests:
          - accepted_values:
              values: ['Management', 'Sales', 'Operations', 'Human Resources', 
                       'Information Technology', 'Finance', 'Marketing', 'Other']
      
      - name: tenure_category
        description: Company tenure category
        tests:
          - accepted_values:
              values: ['New Hire', 'Junior', 'Experienced', 'Veteran']
      
      - name: performance_tier
        description: Performance classification based on sales activity
        tests:
          - accepted_values:
              values: ['No Sales Activity', 'High Performer', 'Standard Performer', 'Low Activity']

  - name: dim_stores
    description: >
      Store dimension with target information, performance, geographic
      classification and operational metrics. Includes operating status and customer loyalty.
    columns:
      - name: store_id
        description: Unique store identifier (PK)
        tests:
          - unique
          - not_null
      
      - name: store_name
        description: Store name
        tests:
          - not_null
      
      - name: store_type
        description: Store type (Retail, Warehouse, Online)
        tests:
          - accepted_values:
              values: ['Retail', 'Warehouse', 'Online']
      
      - name: region
        description: Store geographic region
        tests:
          - accepted_values:
              values: ['West', 'Southwest', 'Midwest', 'Northeast', 'Southeast', 'Other']
      
      - name: monthly_target
        description: Monthly revenue target defined for store
        tests:
          - dbt_utils.at_least_one
      
      - name: operating_status
        description: Current store operating status
        tests:
          - accepted_values:
              values: ['Distribution Center', 'Inactive', 'Active', 'Low Activity', 'Dormant']

  - name: dim_suppliers
    description: >
      Supplier dimension with product portfolio metrics, sales performance
      and classifications by tier, pricing and product diversity.
    columns:
      - name: supplier_id
        description: Unique supplier identifier (PK)
        tests:
          - unique
          - not_null
      
      - name: supplier_name
        description: Supplier name
        tests:
          - not_null
      
      - name: total_products
        description: Total number of products supplied
        tests:
          - dbt_utils.at_least_one
      
      - name: supplier_tier
        description: Supplier classification by strategic importance
        tests:
          - accepted_values:
              values: ['No Active Products', 'Strategic Partner', 'Key Supplier', 
                       'Standard Supplier', 'Minor Supplier']
      
      - name: region
        description: Supplier geographic region
        tests:
          - accepted_values:
              values: ['West', 'Southwest', 'Midwest', 'Northeast', 'Southeast', 'Other']

  - name: dim_dates
    description: >
      Complete calendar dimension with temporal attributes, seasonal
      classifications, holiday indicators and fiscal periods for temporal analysis.
    columns:
      - name: date_id
        description: Date in DATE format (PK)
        tests:
          - unique
          - not_null
      
      - name: year
        description: Year of the date
        tests:
          - not_null
      
      - name: quarter_name
        description: Quarter name (Q1, Q2, Q3, Q4)
        tests:
          - accepted_values:
              values: ['Q1', 'Q2', 'Q3', 'Q4']
      
      - name: month
        description: Full month name
        tests:
          - not_null
      
      - name: day_of_week
        description: Day of week name
        tests:
          - accepted_values:
              values: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 
                       'Friday', 'Saturday', 'Sunday']
      
      - name: is_weekend
        description: Weekend boolean indicator
        tests:
          - accepted_values:
              values: [true, false]
      
      - name: is_weekday
        description: Weekday boolean indicator
        tests:
          - accepted_values:
              values: [true, false]
      
      - name: season
        description: Season of the year
        tests:
          - accepted_values:
              values: ['Winter', 'Spring', 'Summer', 'Fall']
      
      - name: shopping_season
        description: Commercial season for sales analysis
        tests:
          - accepted_values:
              values: ['Holiday Season', 'Post-Holiday', 'Spring Season', 
                       'Summer Season', 'Back-to-School', 'Regular Season']

  - name: fct_orders
    description: >
      Main fact table containing all order transactions
      with aggregated metrics at order level. Base for sales and performance analysis.
    columns:
      - name: order_id
        description: Unique order identifier (PK)
        tests:
          - unique
          - not_null
      
      - name: order_date
        description: Order date for temporal analysis
        tests:
          - not_null
      
      - name: customer_id
        description: FK to dim_customers
        tests:
          - not_null
          - relationships:
              to: ref('dim_customers')
              field: customer_id
      
      - name: employee_id
        description: FK to dim_employees (employee who processed the order)
        tests:
          - not_null
          - relationships:
              to: ref('dim_employees')
              field: employee_id
      
      - name: store_id
        description: FK to dim_stores (store where order was processed)
        tests:
          - not_null
          - relationships:
              to: ref('dim_stores')
              field: store_id
      
      - name: revenue
        description: Total order revenue (sum of line_total from order_items)
        tests:
          - not_null
          - dbt_utils.at_least_one
      
      - name: item_count
        description: Number of unique items in the order
        tests:
          - not_null
          - dbt_utils.at_least_one
      
      - name: total_quantity
        description: Total quantity of products in the order
        tests:
          - not_null
          - dbt_utils.at_least_one
      
      - name: status_desc
        description: Descriptive order status
        tests:
          - accepted_values:
              values: ['Completed', 'In Progress', 'Cancelled', 'Unknown']